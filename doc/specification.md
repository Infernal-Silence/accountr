# Спецификация API

[**Работа с пользователем**](#работа-с-пользователем)
- [Регистрация](#регистрация)
- [Получение информации о пользователе](#получение-информации-о-пользователе)
- [Авторизация](#авторизация)
- [Выход из аккаунта](#выход-из-аккаунта)

[**Работа с операциями**](#работа-с-операциями)
- [Создание операции](#создание-операции)
- [Изменение операции](#изменение-операции)
- [Удаление операции](#удаление-операции)

[**Работа с категориями**](#работа-с-категориями)
- [Добавление категории](#добавление-категории)
- [Изменение категории](#изменение-категории)
- [Удаление категории](#удаление-категории)

[**Работа с отчётами**](#работа-с-отчётами)
- [Получение отчёта](#получение-отчёта)
---
## Работа с пользователем
### Регистрация
URL: `/user/`

Метод: **POST**

Запрос:
```
{
    first_name: str,
    last_name: str,
    email: str,
    password: str
}
```
Код успешного ответа: **200**

Ответ:
```
{
    id: int,
    first_name: str,
    last_name: str,
    email: str
}
```
Примечания:
- Если такой пользователь уже был создан ранее, возвращает код ошибки 409
- Если нет части параметров, возвращает код ошибки 400

---
### Получение информации о пользователе
Требования: 
 - пользователь авторизован
 - пользователь может получить информацию только о себе

URL: `/user/<user_id>`

Метод: **GET**

Запрос: пусто

Код успешного ответа: **200**

Ответ:
```
{
    id: int,
    first_name: str,
    last_name: str,
    email: str
}
```
Примечания:
- Если пользователь не был авторизован, возвращает код ошибки 401
- Если пользователь пытается получить информацию не о себе, возвращает код ошибки 403

---

### Авторизация
URL: `/auth/login/`

Метод: **POST**

Запрос:
```
{
    email: str,
    password: str
}
```
Код успешного ответа: **200**

Ответ:
```
{
    id: int,
    email: str
}
```
Примечания:
- Если логин или пароль неверные, возвращает код ошибки 404

---
### Выход из аккаунта
URL: `/auth/logout/`

Метод: **POST**

Запрос: **пустой**

Код успешного ответа: **200**

Ответ: **пустой**

Примечания:
- Если пользователь не был авторизован, возвращает код ошибки 401

----
## Работа с операциями
### Создание операции
Требования: 
 - пользователь авторизован

URL: 
- `/user/<user_id>/operation`
- `/operation/`

Метод: **POST**

Запрос:
```
{
    user_id: int,
    type_id: int,
    category_id: int,
    amount: float,
    operation_date: date,
    description: str    
}
```
Код успешного ответа: **201**

Ответ:
```
{
    id: int,
    user_id: int,
    type_id: int,
    category_id: int,
    amount: float,
    operation_date: date,
    description: str
}
```
Примечания:
- Если пользователь не был авторизован, возвращает код ошибки 401

----
### Изменение операции
Требования: 
 - пользователь авторизован
 - пользователь обновляет только свою операцию

URL:
- `/user/<user_id>/operation/<id>`
- `/operation/<id>`

Метод: **PATCH**

Запрос:
```
{
    id: int,
    user_id: int,
    type_id: int?,
    category_id: int?,
    amount: float?,
    operation_date: date?,
    description: str?  
}
```
Код успешного ответа: **200**

Ответ:
```
{
    id: int,
    user_id: int,
    type_id: int,
    category_id: int,
    amount: float,
    operation_date: date,
    description: str
}
```
Примечания:
- Если пользователь не был авторизован, возвращает код ошибки 401
- Если пользователь пытается обновить не свою операции, вовзращает код ошибки 403

----
### Удаление операции
Требования: 
 - пользователь авторизован
 - пользователь обновляет только свою операцию

URL:
- `/user/<user_id>/operation/<id>`
- `/operation/<id>`

Метод: **DELETE**

Запрос:
```
{
    id: int,
    user_id: int
}
```
Код успешного ответа: **200**

Ответ:
```
{
    id: int,
    user_id: int,
    type_id: int,
    category_id: int,
    amount: float,
    operation_date: date,
    description: str
}
```
Примечания:
- Если пользователь не был авторизован, возвращает код ошибки 401
- Если пользователь пытается удалить не свою операции, вовзращает код ошибки 403

----
## Работа с категориями
### Добавление категории 
Требования:
 - пользователь авторизован

URL:
- `/user/<user_id>/category/`
- `/category/` 

Метод: **POST**

Запрос:
```
{
    name: str,
    parent_category: int?
}
```
Код успешного ответа: **201**

Ответ:
```
{
    id: int,
    name: str,
    user_id: int,
    parent_id: int?
}
```
Примечания:
- Если пользователь не был авторизован, возвращает код ошибки 401
- Если родительской категорией указана категория, созданная не пользователем, возвращает код ошибки 400
- Если родительской категории не существует, возвращает код ошибки 400
----
### Изменение категории
Требования:
 - пользователь авторизован
 - пользователь изменяет только созданную им категорию

URL:
- `/user/<user_id>/category/<id>`
- `/category/<id>` 

Метод: **PATCH**

Запрос:
```
{
    id: int,
    name: str?,
    parent_id: int?
}
```
Код успешного ответа: **200**

Ответ:
```
{
    id: int,
    name: str,
    user_id: int,
    parent_id: int?
}
```
Примечания:
- Если пользователь не был авторизован, возвращает код ошибки 401
- Если пользователь пытается изменить созданную не им категорию, возвращает код ошибки 403
- Если родительской категорией указана категория, созданная не пользователем, возвращает код ошибки 400
- Если родительской категории не существует, возвращает код ошибки 400
----
### Удаление категории
Требования:
 - пользователь авторизован
 - пользователь удаляет только созданную им категорию

URL:
- `/user/<user_id>/category/<id>`
- `/category/<id>` 

Метод: **DELETE**

Запрос: пустой

Код успешного ответа: **200**

Ответ:
```
{
    id: int,
    name: str,
    user_id: int,
    parent_id: int?
}
```
Примечания:
- Если пользователь не был авторизован, возвращает код ошибки 401
- Если пользователь пытается удалить созданную не им категорию, возвращает код ошибки 403
----
## Работа с отчётами
### Получение отчёта
